properties:
  environmentId: {aca-env-resource-id}
  identity:
    type: SystemAssigned
  configuration:
    activeRevisionsMode: Single
    registries:
      - server: {acr-name}.azurecr.io
        identity: system
    ingress:
      external: true
      targetPort: 8080
      transport: auto
      allowInsecure: false
  template:
    containers:
      - name: storefront-frontend
        image: {acr-name}.azurecr.io/storefront-frontend:{image-tag}
        resources:
          cpu: 0.25
          memory: 0.5Gi
        env:
          - name: APPLICATIONINSIGHTS_CONNECTION_STRING
            value: {app-insights-connection-string}
          - name: ORDERS_API_URL
            value: http://orders-api
          - name: OTEL_SERVICE_NAME
            value: storefront-frontend
          - name: OTEL_RESOURCE_ATTRIBUTES
            value: service.namespace=aca-demo,service.instance.id=$(HOSTNAME)
    scale:
      minReplicas: 1
      maxReplicas: 5
      rules:
        - name: http-rule
          http:
            metadata:
              concurrentRequests: '20'
